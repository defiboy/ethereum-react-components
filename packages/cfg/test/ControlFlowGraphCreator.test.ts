import { ControlFlowGraphCreator } from '../src'

describe('ControlFlowGraphCreator tests', () => {
  let controlFlowGraphInstance: ControlFlowGraphCreator

  beforeEach(() => {
    controlFlowGraphInstance = new ControlFlowGraphCreator()
  })

  test('control flow graph is created correctly [buildControlFlowGraphFromBytecode]', () => {
    const simpleStorageBytecode = "608060405234801561001057600080fd5b506103e860008190555033600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506101928061006a6000396000f3fe608060405234801561001057600080fd5b50600436106100365760003560e01c8063209652551461003b5780635524107714610059575b600080fd5b610043610087565b6040518082815260200191505060405180910390f35b6100856004803603602081101561006f57600080fd5b8101908080359060200190929190505050610090565b005b60008054905090565b3373ffffffffffffffffffffffffffffffffffffffff16600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614610153576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260188152602001807f4f6e6c79206f776e65722063616e207365742076616c7565000000000000000081525060200191505060405180910390fd5b806000819055505056fea265627a7a72315820248935eef76f2e30e97cadcb0097f04f8b1493b1ad7a90ede90364e65470d1d164736f6c634300050e0032"

    const result = controlFlowGraphInstance.buildControlFlowGraphFromBytecode(simpleStorageBytecode)

    console.log("Blocks", JSON.stringify(result.contractRuntime.blocks))

    expect(result).toBeTruthy()
    expect(result.contractRuntime.blocks).toBeDefined()
  })
})


